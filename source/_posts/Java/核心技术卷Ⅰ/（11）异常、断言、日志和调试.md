title: 异常、断言、日志和调试
description: 异常、断言、日志和调试
categories: 
  - Java
  - 核心技术卷I
author: Jade
date: 2022-01-13 17:00:00
---

{% markmap %}

## 11.1 处理错误
- 对于异常情况，Java使用一种称为异常处理的错误捕获机制处理。
- 如果由于出现错误而使得某些操作没有完成，程序应该 返回到一种安全状态，并能够让用户执行一些其他的命令； 或者允许用户保存所有的操作的结果，并以适当的方式终止程序。
- 在Java中，如果某个方法不能够采用正常的途径完整它的任务，就可以通过另外一个路径退出方法。throw。
- 调用这个方法的代码也将无法继续执行，异常处理机制开始搜索能够处理这种异常状况的异常处理器。

- 在Java程序设计语言中，异常对象都是派生于Throwable类的一个实例。
- Throwable => Error、Exception。
- Error类层次结构描述了Java运行时系统的内部错误和资源耗尽错误。应用程序不应该抛出这种类型的对象。
- Exception => RuntimeException、其它异常。
- Java语言规范将派生于Error类或RuntimeException类的所有异常称为未检查异常，所有其它的异常称为已检查异常。
- 编译器将检查是否为所有的已检查异常提供了异常处理器。
- 对于那些可能被他人使用的Java方法，应该根据异常规范，在方法的首部声明这个方法可能抛出的异常。
- 子类方法中声明的已检查异常不能比超类方法中声明的异常更通用。
- 如果超类方法没有抛出任何已检查异常，子类也不能抛出任何已检查异常。
- 抛出异常：throw。
- 创建异常类：定义一个派生于Exception的类，或者派生于Exception子类的类。

## 11.2 捕获异常
- 要想捕获一个异常，必须设置try/catch语句块。
- 如果在try语句块中的任何代码抛出了一个在catch子句中说明的异常类，那么程序将跳过try语句块的其余代码，将执行catch子句中的处理器代码。
- 如果在try语句块中的代码没有抛出异常，那么程序将跳过catch子句。
- 如果方法中的任何代码抛出了一个在catch子句中没有声明的异常类型，那么这个方法就会立刻退出。

- 在一个try语句块中可以捕获多个异常类型，并对不同类型的异常做出不同的处理。
- 在Java SE 7中，同一个catch子句中可以捕获多个异常类型。

- 在catch子句中可以抛出一个异常，这样做的目的时改变异常的类型。

- 不管是否由异常被捕获，finally子句中的代码都被执行。

- Java SE7提供了try-with-resources。

- 堆栈跟踪时一个方法调用过程的列表，它包含了程序执行过程中方法调用的特定位置。
- printStackTrace、getStackTrace、getAllStackTrace。

## 11.3 使用异常机制的技巧
- 异常处理不能代替简单的测试。
- 不要过分的细化异常。
- 利用异常层次结构。
- 不要压制异常。
- 在检查错误时，苛刻要比放任更好。
- 不要羞于传递异常。

## 11.4 使用断言
- 在一个具有自我保护能力的程序中，断言很常用。
- 断言机制允许在测试期间向代码中插入一些检查语句。当代码发布时，这些插入的检测语句将会被自动地移走。
- Java语言引入了关键字assert。有两种形式： assert 条件; 、 assert 条件:表达式;。
- 表达式部分的唯一目的是产生一个消息字符串。
- 在默认情况下，断言被禁用。可以在运行程序时用-enableassertions或-ea选项启用它。
- 启用或禁用断言时类加载器的功能。当断言被禁用时，类加载器将跳过断言代码，不会降低程序运行的速度。
- 也可以在某个类或某个包中使用/禁用断言。

- 断言失败是致命的、不可恢复的错误。
- 断言检查只用于开发和测试阶段。
- 断言是一种测试和调试阶段所使用的战术性工具；而日志记录是一种在程序的整个生命周期都可以使用的策略性工具。

## 11.5 记录日志
- 可以很容易地取消全部日志记录，或者仅仅取消某个级别的日志，而且打开和关闭这个操作也很容易。
- 可以很简单地禁止日志记录的输出，因此，将这些日志代码留在程序中的开销很小。
- 日志记录可以被定向到不同的处理器，用于在控制台中显示，用于存储在文件中等。
- 日志记录器和处理器都可以对进路进行过滤。过滤器可以根据过滤器实现器指定的标准丢弃那些无用的记录项。
- 日志记录可以采用不同的方式格式化。
- 应用程序可以使用多个日志记录器，它们使用类似包名的这种具有层次结构的名字。
- 在默认情况下，日志系统的配置由配置文件控制。如果需要的话，应用程序可以替换这个配置。

## 11.6 调试技巧
- System.out、log。
- 每个类中放置一个main方法。
- JUnit。
- 日志代理。
- Throwable.printStackTrace。
- System.err。
- 文件。
- Xlint选项告诉编译器对一些普遍容易出现的代码问题进行检查。
- jconsole。
- jmap。
- Xprof标志。

## 11.7 GUI程序排错技巧

## 11.8 使用调试器

{% endmarkmap %}
