title: 运行时数据区
categories:
  - Java
  - JVM
description: 运行时数据区
author: Jade
date: 2021-12-16 17:00:00
---

## 运行时数据区
堆、方法区、程序寄存器、虚拟机栈、本地方法栈。
其中 堆、方法区是线程共享的，其它是每个线程各自的数据。

## 程序寄存器
每个CPU核心循环执行线程，使用程序寄存器保存当前方法执行的地方，以便下次执行。
唯一不会内存溢出的区域。

## 虚拟机栈
保存方法调用栈，每次Java方法调用产生一个栈帧入栈，方法调用结束出栈。
每个栈帧包括 局部变量表、操作数栈、动态链接、方法出口。

### 局部变量表
编译时确定大小。
非static方法第一个参数为调用对象。

### 操作数栈
用来准备调用方法参数以及接受方法的返回结果。 ？？？
用来处理操作数操作符 ？？？

### 动态链接
用来完成运行时绑定操作。 -- 实现？？？

## 本地方法栈
与虚拟机栈功能一致，但针对的时native方法。
在HotSpot虚拟机中，虚拟机栈与本地方法栈合二为一。

## 方法区
存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码。

### 运行时常量池
字面量等等。
永久代。
属于类信息的一部分，还是单独保存？？？

## 堆
内存最大的区域，垃圾回收器主要作用的地方。
分为新生代（Eden + From Survivor0 + To Survivor1）、老年代。

### JVM常见参数
- -Xms： 堆容量初始大小。
- -Xmx： 堆最大大小。
- -Xmn： 新生代容量大小。
- -XX:SurvivorRatio: 设置新生代各部分比例。默认为8：1：1。

## JDK 8
将方法区改为MetaSpace。
把方法区中的字符串常量池保存到堆中。
去掉永久代的概念。
