title: 注解
description: 注解
categories: 
  - Java
  - 编程思想
author: Jade
date: 2021-12-28 10:00:00
---

{% markmap %}

## 20.0 序
- 注解为在代码中添加信息提供了一种形式化的方法，使得可以在稍后某个时刻非常方便地使用这些数据。
- 注解在一定程度上是在把元数据与源代码文件结合在一起，而不是保存在外部文档中这一大的趋势之下所催生的。
- 注解是众多引入到Java SE5中的重要的语言变化之一。
- 注解可以提供用来完整地描述程序所需的信息，而这些信息是无法用Java来表达的。
- 注解的语法比较简单，除了@符号的使用之外，基本与Java固有的语法一致。
- Java SE5内置了三种，定义在java.lang中的注解：@Override、@Deprecated、@SuppressWarnings。
- Java另外提供了四种注解，专门负责新注解的创建。
- 注解的出现，可以替代某些现存的系统。
- 注解是真正的语言级的概念，一旦构造出来，就享有编译期的类型检查保护。
- 注解是在实际的源代码级别保存所有的信息，而不是某种注释性的文字，这使得代码更整洁，且便于维护。
- 通过使用扩展的annotation API，或外部的字节码工具类库，拥有对源代码以及字节码强大的检查与操作能力。

## 20.1 基本语法
- 被注解的方法与其它的方法没有区别。
- 从语法的角度来看，注解的使用方式几乎与修饰符的使用一摸一样。
- 注解的定义看起来很像接口的定义。事实上，与其他任何Java接口一样，注解也将会编译成class文件。
- 在注解中，一般都会包含一些元素以表示某些值。没有元素的注解称为标记注解。
- 元注解负责注解其他的注解：@Target、@Retention、@Documented、@Inherited。

## 20.2 编写注解处理器
- 使用注解的过程中，很重要的一个部分就是创建与使用注解处理器（用来读取注解的工具）。
- Java SE5扩展了反射机制的API，以帮助构造注解处理器。
- 同时，还提供了一个外部工具apt帮助解析带有注解的Java源代码。

- 注解元素可用的类型：基本类型、String、Class、enum、Annotation、以上类型的数组。

- 注解元素不能由不确定的值。对于非基本类型的元素，不能以null作为其值。

- 使用注解将信息保存在JavaBean源文件中。
- 快捷方式。名为value的元素。
- 可以使用多种不同的方式来定义自己的注解。
- 编译器允许对一个目标同时使用多个注解。同一个注解不能重复使用。

- 不能使用关键字extends来继承某个@interface。

## 20.3 使用apt处理注解
- 注解处理工具apt是Sun为了帮助注解的处理过程而提供的工具。
- apt被设计为操作Java源文件，而不是编译后的类。
- 自定义的每一个注解都需要自己的处理器，而apt工具能够很容易地将多个注解处理器结合在一起。
- 通过使用AnnotationProcessorFactory，apt能够为每一个它发现的注解生成一个正确的注解处理器。

## 20.4 将观察者模式用于apt
- 一个访问者会遍历某个数据结构或一个对象的集合，对其中的每一个对象执行一个操作。

## 20.5 基于注解的单元测试
- 单元测试是对类中的每个方法提供一个或多个测试的一种实践，其目的是为了有规律地测试一个类的各个部分是都具备正确的行为。
- 在Java中，最著名的单元测试工具是JUnit。
- 有了注解，可以直接在要验证的类里面编写测试，这将大大减少单元测试所需的时间和麻烦之处。
- 单元测试的方法没有参数，且返回值是boolean或void。
- 编写单元测试时，唯一需要做的就是决定测试是成功还是失败。
- 要生成一个非嵌入式的测试，最简单的办法就是继承。还可以使用组合的方式创建非嵌入式的测试。
- Java的断言机制一般要求在命令行中加上-ea标志。
- 如果创建对象的类没有默认构造器， 或者新对象需要复杂的构造过程，可以创建一个static方法专门负责构造对象。
- 用注解标记的域表示只在单元测试中使用。
- 也可以标记只在测试中使用的方法，而本身并不是测试方法。

- 测试必须针对某个特定类型的参数或参数集才能进行。 -- 让测试类继承自泛型类的一个特定版本即可。

- 用套件来组织测试。

- 开源的Java assist工具类库将字节码工程带入了一个可行的领域。 -- 可以根据注解删除所有的单元测试。

## 20.6 总结
- 注解是Java引入的一项非常受欢迎的补充。

{% endmarkmap %}